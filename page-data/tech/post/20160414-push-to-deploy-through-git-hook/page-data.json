{"componentChunkName":"component---node-modules-gatsby-theme-replica-src-templates-post-tsx","path":"/tech/post/20160414-push-to-deploy-through-git-hook/","result":{"data":{"post":{"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"如何通过Git钩子自动部署(Push to Deploy)\",\n  \"date\": \"2016-04-14T10:59:37.000Z\",\n  \"tags\": [\"git\", \"hook\", \"自动部署\"],\n  \"category\": \"git\"\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"\\u770B\\u4E86\\u597D\\u591A\\u8BB2\\u901A\\u8FC7 git \\u94A9\\u5B50\\u81EA\\u52A8\\u90E8\\u7F72\\u7684\\uFF0C\\u5927\\u591A\\u8BB2\\u7684\\u7ED5\\u6765\\u7ED5\\u53BB\\u4E71\\u4E03\\u516B\\u7CDF\\u601D\\u8DEF\\u4E00\\u70B9\\u4E5F\\u4E0D\\u6E05\\u6670\\u2026\\n\\u505A\\u4E86\\u4E00\\u665A\\u4E0A\\u5B9E\\u9A8C\\u4E4B\\u540E\\u5927\\u6982\\u660E\\u767D\\u4E86\\u662F\\u600E\\u4E48\\u5DE5\\u4F5C\\u7684\\u3002\"), mdx(\"h3\", null, \"\\u88F8\\u4ED3\\u5E93\\uFF08bare\\uFF09\"), mdx(\"p\", null, \"\\u88F8\\u4ED3\\u5E93\\u8DDF\\u6211\\u4EEC\\u5E73\\u65F6\", mdx(\"inlineCode\", {\n    \"parentName\": \"p\"\n  }, \"git clone\"), \"\\u5F97\\u5230\\u7684\\u4ED3\\u5E93\\u4E0D\\u592A\\u4E00\\u6837\\uFF0C\\u88F8\\u4ED3\\u5E93\\u5176\\u5B9E\\u76F8\\u5F53\\u4E8E\\u901A\\u8FC7\\u514B\\u9686\\u6765\\u7684\\u4ED3\\u5E93\\u91CC\\u7684\", mdx(\"inlineCode\", {\n    \"parentName\": \"p\"\n  }, \".git\"), \"\\u6587\\u4EF6\\u5939\\uFF0C\\u6574\\u4E2A\\u88F8\\u4ED3\\u5E93\\u4E2D\\u53EA\\u6709 git \\u7D22\\u5F15\\uFF08index\\uFF09\\uFF0C\", mdx(\"strong\", {\n    \"parentName\": \"p\"\n  }, \"\\u5E76\\u6CA1\\u6709\\u4EFB\\u4F55\\u4EE3\\u7801\\u76F8\\u5173\\u7684\\u4E1C\\u897F\"), \"\\u3002\\u8981\\u5B9E\\u73B0 Push to Deploy\\uFF0C\\u9996\\u5148\\u6211\\u4EEC\\u9700\\u8981\\u4E00\\u4E2A\\u88F8\\u4ED3\\u5E93\\u3002\"), mdx(\"p\", null, \"\\u5728\\u514B\\u9686\\u65F6\\u4F7F\\u7528 \", mdx(\"inlineCode\", {\n    \"parentName\": \"p\"\n  }, \"--bare\"), \"\\u53C2\\u6570\\u6765\\u514B\\u9686\\u4E00\\u4E2A\\u88F8\\u4ED3\\u5E93\"), mdx(\"pre\", null, mdx(\"code\", {\n    \"className\": \"language-bash\",\n    \"parentName\": \"pre\"\n  }, \"git init --bare xxx-bare\\n\")), mdx(\"h3\", null, \"\\u94A9\\u5B50\\uFF08hook\\uFF09\"), mdx(\"p\", null, \"\\u666E\\u901A\\u4ED3\\u5E93\", mdx(\"inlineCode\", {\n    \"parentName\": \"p\"\n  }, \".git\"), \"\\u6587\\u4EF6\\u5939\\u4E0B\\u6709\\u4E00\\u4E2A\", mdx(\"inlineCode\", {\n    \"parentName\": \"p\"\n  }, \"hooks\"), \"\\u6587\\u4EF6\\u5939\\uFF0C\\u88F8\\u4ED3\\u5E93\\u4E0B\\u76F4\\u63A5\\u6709\\u4E00\\u4E2A\", mdx(\"inlineCode\", {\n    \"parentName\": \"p\"\n  }, \"hooks\"), \"\\u6587\\u4EF6\\u5939\\uFF0C\\u91CC\\u9762\\u6709\\u5404\\u79CD\\u5404\\u6837\\u4EE5\", mdx(\"inlineCode\", {\n    \"parentName\": \"p\"\n  }, \".sample\"), \"\\u7ED3\\u5C3E\\u7684\\u94A9\\u5B50\\uFF0C\\u5F53\\u628A\", mdx(\"inlineCode\", {\n    \"parentName\": \"p\"\n  }, \".sample\"), \"\\u540E\\u7F00\\u5220\\u9664\\u65F6\\uFF0C\\u94A9\\u5B50\\u5C31\\u662F\\u6FC0\\u6D3B\\u72B6\\u6001\\u3002\"), mdx(\"pre\", null, mdx(\"code\", {\n    \"parentName\": \"pre\"\n  }, \".git\\n\\u251C\\u2500\\u2500\\u2500hooks\\n\\u2502   \\u2514\\u2500\\u2500\\u2500post-update.sample\\n\\u2514\\u2500\\u2500\\u2500 ...\\n\")), mdx(\"p\", null, \"\\u4F60\\u53EF\\u4EE5\\u5728\\u94A9\\u5B50\\u6587\\u4EF6\\u91CC\\u5199\\u4E00\\u4E9B bash \\u547D\\u4EE4\\uFF0C\\u88AB\\u6FC0\\u6D3B\\u7684\\u94A9\\u5B50\\u88AB\\u89E6\\u53D1\\u65F6\\u4F1A\\u6267\\u884C\\u4F60\\u7684 bash \\u547D\\u4EE4\\u3002\"), mdx(\"p\", null, \"\\u4E0E deploy \\u76F8\\u5173\\u7684\\u901A\\u5E38\\u4F7F\\u7528\", mdx(\"inlineCode\", {\n    \"parentName\": \"p\"\n  }, \"post-update\"), \"\\u94A9\\u5B50\\u6216\\u8005\", mdx(\"inlineCode\", {\n    \"parentName\": \"p\"\n  }, \"post-receive\"), \"\\u94A9\\u5B50\", mdx(\"sup\", {\n    \"id\": \"fnref-1\",\n    \"parentName\": \"p\"\n  }, mdx(\"a\", {\n    \"href\": \"#fn-1\",\n    \"className\": \"footnote-ref\",\n    \"parentName\": \"sup\"\n  }, \"1\")), \"\\uFF0C\\u5173\\u4E8E\\u8FD9\\u4E24\\u4E2A\\u94A9\\u5B50\\u5230\\u5E95\\u6709\\u4EC0\\u4E48\\u4E0D\\u540C\\uFF0C\\u6211\\u662F\\u6CA1\\u592A\\u770B\\u61C2\\uFF0C\\u5927\\u6982\\u7684\\u7406\\u89E3\\u662F\\u8FD9\\u4E24\\u4E2A\\u94A9\\u5B50\\u88AB trigger \\u7684\\u65F6\\u5019\\u6536\\u5230\\u7684\\u4FE1\\u606F\\u4E0D\\u4E00\\u6837\\uFF0C\\u5982\\u679C\\u9700\\u8981\\u7528 commit \\u7684\\u76F8\\u5173\\u4FE1\\u606F\\u6765\\u505A\\u4E00\\u4E9B\\u4E8B\\u60C5\\u7684\\u8BDD\\u8981\\u4ED4\\u7EC6\\u7814\\u7A76\\uFF08\\u6BD4\\u5982\\u53EF\\u4EE5\\u8BBE\\u7F6E\\u67D0\\u4E2A\\u5206\\u652F\\u6536\\u5230\\u4E86\\u63A8\\u9001\\u5C31\\u505A\\u76F8\\u5E94\\u7684\\u4E8B\\u60C5\\u4E4B\\u7C7B\\uFF09\\uFF0C\\u5176\\u4ED6\\u5982\\u679C\\u53EA\\u662F\\u901A\\u8FC7 bash \\u6765\\u8DD1\\u4E00\\u4E9B node \\u76F8\\u5173\\u7684\\u90E8\\u7F72\\u547D\\u4EE4\\uFF0C\\u4E24\\u4E2A\\u90FD\\u53EF\\u4EE5\\u3002\\u8FD9\\u7BC7\\u6587\\u7AE0\\u53EA\\u7ED9\\u4E00\\u4E2A\\u6700\\u7B80\\u5355\\u7684\\u4F8B\\u5B50\\uFF0C\\u8DDF\\u5206\\u652F\\u554A\\u4EC0\\u4E48\\u7684\\u90FD\\u6CA1\\u5173\\u7CFB\\uFF0C\\u53EA\\u8981\\u6536\\u5230\\u63A8\\u9001\\u5C31\\u90E8\\u7F72\\u3002\"), mdx(\"p\", null, \"\\u8981\\u5B9E\\u73B0 Push to Deploy\\uFF0C\\u6211\\u4EEC\\u9700\\u8981\\u4FEE\\u6539\\u88F8\\u4ED3\\u5E93\\u4E2D\\u76F8\\u5E94\\u7684\\u94A9\\u5B50\\u6587\\u4EF6\"), mdx(\"h3\", null, \"\\u88F8\\u4ED3\\u5E93\\u662F\\u600E\\u4E48\\u5DE5\\u4F5C\\u7684\"), mdx(\"p\", null, \"\\u53EF\\u4EE5\\u5728\\u672C\\u5730\\u540C\\u4E00\\u4E2A\\u6587\\u4EF6\\u5939\\u4E0B\\u5148\\u521B\\u5EFA\\u4E00\\u4E2A\\u88F8\\u4ED3\\u5E93\\u540D\\u4E3A xxx-remote\\uFF08\\u6A21\\u62DF\\u8FDC\\u7A0B\\u670D\\u52A1\\u5668\\uFF09\\uFF0C\\u518D\\u521B\\u5EFA\\u4E00\\u4E2A xxx-local \\u4ED3\\u5E93\\uFF08\\u6A21\\u62DF\\u672C\\u5730\\uFF09\\uFF0C\\u5C06 xxx-remote \\u6DFB\\u52A0\\u4E3A\\u672C\\u5730\\u4ED3\\u5E93\\u7684\\u8FDC\\u7A0B\\u4ED3\\u5E93\\uFF0C\\u5728\\u672C\\u5730\\u4ED3\\u5E93\\u5199\\u4E00\\u4E2A\", mdx(\"inlineCode\", {\n    \"parentName\": \"p\"\n  }, \"README.md\"), \"\\u6587\\u4EF6\\uFF0C\\u63D0\\u4EA4\\u5E76 push\"), mdx(\"pre\", null, mdx(\"code\", {\n    \"className\": \"language-bash\",\n    \"parentName\": \"pre\"\n  }, \"git init --bare xxx-remote\\ngit init xxx-local\\ncd xxx-local\\ngit remote add origin ../xxx-remote\\necho test123>README.md\\ngit add .\\ngit commit -m 'add readme file'\\ngit push -u origin master\\n\")), mdx(\"p\", null, \"\\u4E4B\\u540E\\u5207\\u6362\\u5230\\u8FDC\\u7A0B\\u4ED3\\u5E93\\u6587\\u4EF6\\u5939\\uFF0C\\u67E5\\u770B git log\"), mdx(\"pre\", null, mdx(\"code\", {\n    \"className\": \"language-bash\",\n    \"parentName\": \"pre\"\n  }, \"cd ..\\ncd xxx-remote\\ngit log\\n\")), mdx(\"p\", null, \"\\u5C06\\u80FD\\u591F\\u770B\\u5230\\u6709\\u4E00\\u6761 commit \\u8BB0\\u5F55\\uFF0C\\u63D0\\u4EA4\\u4FE1\\u606F\\u662F add readme file\\uFF0C\\u8FDC\\u7A0B\\u4ED3\\u5E93\\u6536\\u5230\\u4E86\\u672C\\u5730\\u4ED3\\u5E93\\u7684 push\"), mdx(\"h3\", null, \"\\u94A9\\u5B50\\u662F\\u600E\\u4E48\\u5DE5\\u4F5C\\u7684\"), mdx(\"p\", null, \"\\u8FDB\\u5165\\u8FDC\\u7A0B\\u4ED3\\u5E93\\uFF0C\\u5C06\", mdx(\"inlineCode\", {\n    \"parentName\": \"p\"\n  }, \"hooks\"), \"\\u6587\\u4EF6\\u5939\\u4E0B\\u7684\", mdx(\"inlineCode\", {\n    \"parentName\": \"p\"\n  }, \"post-update.sample\"), \"\\u6539\\u540D\\u4E3A\", mdx(\"inlineCode\", {\n    \"parentName\": \"p\"\n  }, \"post-update\"), \"\\uFF0C\\u6253\\u5F00\\u5E76\\u7F16\\u8F91\\u4E3A\\u5982\\u4E0B\\u5185\\u5BB9\\uFF1A\"), mdx(\"pre\", null, mdx(\"code\", {\n    \"parentName\": \"pre\"\n  }, \"#!/bin/sh\\nset -x #\\u663E\\u793A\\u6BCF\\u6761\\u547D\\u4EE4\\necho \\\"push push\\\"\\n\")), mdx(\"p\", null, \"\\u4FEE\\u6539\\u672C\\u5730\\u4ED3\\u5E93\\u7684\\u6587\\u4EF6\\uFF0C\\u8FDB\\u884C\\u4E00\\u6B21\\u63A8\\u9001\\uFF0C\\u5C06\\u4F1A\\u770B\\u5230\\u8FDC\\u7A0B\\u670D\\u52A1\\u5668\\u6267\\u884C\\u4E86\\u76F8\\u5E94\\u7684\\u547D\\u4EE4\"), mdx(\"pre\", null, mdx(\"code\", {\n    \"parentName\": \"pre\"\n  }, \"Total 0 (delta 0), reused 0 (delta 0)\\nremote: + echo push push\\nremote: push push\\nTo ../xxx\\n + 41b78ee...055cec9 master -> master (forced update)\\n\")), mdx(\"h3\", null, \"\\u4E00\\u4E2A\\u5B8C\\u6574\\u7684\\u573A\\u666F\\u4E3E\\u4F8B\"), mdx(\"p\", null, \"\\u5047\\u8BBE\\u6709\\u4E00\\u53F0\\u8FDC\\u7A0B\\u670D\\u52A1\\u5668\\u4E0A\\u8DD1\\u7740\\u4E00\\u4E2A\\u7F51\\u7AD9\\uFF0C\\u5E0C\\u671B\\u6BCF\\u6B21 git push \\u4E4B\\u540E\\u8FD9\\u4E2A\\u7F51\\u7AD9\\u5C31\\u81EA\\u52A8\\u66F4\\u65B0\\u3002\\n\\u4E3A\\u4E86\\u65B9\\u4FBF\\uFF1A\"), mdx(\"ul\", null, mdx(\"li\", {\n    \"parentName\": \"ul\"\n  }, \"\\u5047\\u8BBE\\u8FDC\\u7A0B\\u670D\\u52A1\\u5668\\u4E0A\\u653E\\u4E86\", mdx(\"strong\", {\n    \"parentName\": \"li\"\n  }, \"\\u88F8\\u4ED3\\u5E93\"), \"\\u548C\", mdx(\"strong\", {\n    \"parentName\": \"li\"\n  }, \"\\u7F51\\u7AD9\"), \"\\uFF0C\\u81EA\\u52A8\\u90E8\\u7F72\\u7684\\u8FC7\\u7A0B\\u5C31\\u662F\\u88F8\\u4ED3\\u5E93\\u6536\\u5230 push \\u4E4B\\u540E\\u66F4\\u65B0\\u4E00\\u4E0B\\u7F51\\u7AD9\\u7684\\u6587\\u4EF6\\u5939\"), mdx(\"li\", {\n    \"parentName\": \"ul\"\n  }, \"\\u5047\\u8BBE\\u7F51\\u7AD9\\u90FD\\u662F\\u9759\\u6001\\u6587\\u4EF6\\uFF0C\\u4E0D\\u9700\\u8981\\u91CD\\u542F web server\"), mdx(\"li\", {\n    \"parentName\": \"ul\"\n  }, \"\\u5047\\u8BBE\\u90FD\\u53EA\\u8003\\u8651\\u9ED8\\u8BA4\\u7684 master \\u5206\\u652F\")), mdx(\"p\", null, \"\\u6211\\u4EEC\\u9700\\u8981\\uFF1A\"), mdx(\"ol\", null, mdx(\"li\", {\n    \"parentName\": \"ol\"\n  }, \"\\u5728\\u8FD9\\u53F0\\u8FDC\\u7A0B\\u670D\\u52A1\\u5668\\u4E0A\\u521B\\u5EFA\\u4E00\\u4E2A\\u88F8\\u4ED3\\u5E93\\uFF0C\\u5047\\u5982\\u540D\\u53EB xxx\\u3002\\u514B\\u9686 repo \\u53D6\\u540D\\u4E3A website\\uFF0C\\u7528\\u4E8E\\u5B58\\u653E\\u7F51\\u7AD9\\u6587\\u4EF6\")), mdx(\"pre\", null, mdx(\"code\", {\n    \"className\": \"language-bash\",\n    \"parentName\": \"pre\"\n  }, \"git init --bare xxx\\ngit clone ./xxx website\\n\")), mdx(\"ol\", {\n    \"start\": 2\n  }, mdx(\"li\", {\n    \"parentName\": \"ol\"\n  }, \"\\u4FEE\\u6539\\u8FDC\\u7A0B\\u670D\\u52A1\\u5668\\u4E0B\", mdx(\"inlineCode\", {\n    \"parentName\": \"li\"\n  }, \"hooks\"), \"\\u6587\\u4EF6\\u5939\\u4E0B\\u7684\", mdx(\"inlineCode\", {\n    \"parentName\": \"li\"\n  }, \"post-update.sample\"), \"\\u6539\\u540D\\u4E3A\", mdx(\"inlineCode\", {\n    \"parentName\": \"li\"\n  }, \"post-update\"), \"\\uFF0C\\u7F16\\u8F91\\u4E3A\\u5982\\u4E0B\\u5185\\u5BB9\\uFF1A\")), mdx(\"pre\", null, mdx(\"code\", {\n    \"parentName\": \"pre\"\n  }, \"#!/bin/sh\\nset -x #\\u663E\\u793A\\u6BCF\\u6761\\u547D\\u4EE4\\ngit reset --hard origin/master #\\u9632\\u6B62\\u56E0\\u4E3Aforced push\\u800C\\u5BFC\\u81F4\\u65E0\\u6CD5checkout\\ngit checkout\\n\")), mdx(\"ol\", {\n    \"start\": 3\n  }, mdx(\"li\", {\n    \"parentName\": \"ol\"\n  }, \"\\u5728\\u672C\\u5730 repo \\u6DFB\\u52A0\\u8FDC\\u7A0B\\u4ED3\\u5E93\")), mdx(\"pre\", null, mdx(\"code\", {\n    \"className\": \"language-bash\",\n    \"parentName\": \"pre\"\n  }, \"git remote add origin ubuntu@59.64.123.123:home/xxx.git\\n\")), mdx(\"p\", null, \"4.\\u5728\\u672C\\u5730\\u4ED3\\u5E93\\u4FEE\\u6539\\u6587\\u4EF6\\u5E76 push\"), mdx(\"p\", null, \"\\u81F3\\u6B64\\u6574\\u4E2A git \\u81EA\\u52A8\\u90E8\\u7F72\\u7684\\u8FC7\\u7A0B\\u5C31\\u5B8C\\u6210\\u4E86\"), mdx(\"div\", {\n    \"className\": \"footnotes\"\n  }, mdx(\"hr\", {\n    \"parentName\": \"div\"\n  }), mdx(\"ol\", {\n    \"parentName\": \"div\"\n  }, mdx(\"li\", {\n    \"id\": \"fn-1\",\n    \"parentName\": \"ol\"\n  }, mdx(\"a\", {\n    \"href\": \"https://www.kernel.org/pub/software/scm/git/docs/githooks.html\",\n    \"parentName\": \"li\"\n  }, \"https://www.kernel.org/pub/software/scm/git/docs/githooks.html\"), mdx(\"a\", {\n    \"href\": \"#fnref-1\",\n    \"className\": \"footnote-backref\",\n    \"parentName\": \"li\"\n  }, \"\\u21A9\")))));\n}\n;\nMDXContent.isMDXComponent = true;","excerpt":"看了好多讲通过 git 钩子自动部署的，大多讲的绕来绕去乱七八糟思路一点也不清晰…\n做了一晚上实验之后大概明白了是怎么工作的。 裸仓库（bare） 裸仓库跟我们平时 git clone…","fields":{"slug":"/post/20160414-push-to-deploy-through-git-hook/"},"frontmatter":{"date":"2016-04-14T10:59:37.000Z","title":"如何通过Git钩子自动部署(Push to Deploy)","tags":["git","hook","自动部署"],"category":"git"},"tableOfContents":{"items":[{"url":"#裸仓库（bare）","title":"裸仓库（bare）"},{"url":"#钩子（hook）","title":"钩子（hook）"},{"url":"#裸仓库是怎么工作的","title":"裸仓库是怎么工作的"},{"url":"#钩子是怎么工作的","title":"钩子是怎么工作的"},{"url":"#一个完整的场景举例","title":"一个完整的场景举例"}]},"timeToRead":1}},"pageContext":{"postID":"df1890ef-432e-58d8-b5e7-8e3c09719b01","numericId":28,"prevPost":{"slug":"/post/20160412-babel-mocha-istanbul-es6-testing-and-coverage/","title":"结合使用Babel Mocha Istanbul进行ES6代码测试和覆盖率测试"},"nextPost":{"slug":"/post/20160421-theory-analysis-for-wechat-recall-message-nickname/","title":"微信撤回信息昵称显示原理分析"}}},"staticQueryHashes":["2873555300"]}