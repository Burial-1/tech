{"componentChunkName":"component---node-modules-gatsby-theme-replica-src-templates-post-tsx","path":"/tech/post/20160118-sequentialize-promise-by-recursion/","result":{"data":{"post":{"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"递归实现按顺序执行Promise\",\n  \"date\": \"2016-01-18T09:23:18.000Z\",\n  \"tags\": [\"promise\", \"递归\"],\n  \"category\": \"JS\"\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, mdx(\"strong\", {\n    \"parentName\": \"p\"\n  }, \"2016-01-24 \\u66F4\\u65B0\"), \"\\n\\u6211\\u8FD8\\u662F\\u89C9\\u5F97\\u5D4C\\u5957\\u591A\\u5C42\\u7684 promise \\u662F\\u53CD\\u6A21\\u5F0F\\uFF0C\\u4E0D\\u63A8\\u8350\\u4F7F\\u7528\\uFF0C\\u673A\\u667A\\u7684\\u6211\\u5B66\\u4F1A\\u4E86\\u53E6\\u4E00\\u79CD\\u4E0D\\u5D4C\\u5957\\u4E0D\\u9012\\u5F52\\u7684\\u65B9\\u6CD5\\uFF0C\\u8BF7\\u770B\\u8FD9\\u91CC\\uFF1A\\n\", mdx(\"a\", {\n    \"href\": \"http://sabrinaluo.github.io/tech/2016/01/23/excecute-parallel-promise-and-sequential-promise/\",\n    \"parentName\": \"p\"\n  }, \"Promise \\u7684\\u987A\\u5E8F\\u6267\\u884C\\u548C\\u5E76\\u884C\\u6267\\u884C\")), mdx(\"p\", null, mdx(\"strong\", {\n    \"parentName\": \"p\"\n  }, \"\\u4EE5\\u4E0B\\u4E3A\\u539F\\u6587\\uFF1A\")), mdx(\"p\", null, \"\\u4E4B\\u524D\\u6211\\u4E00\\u76F4\\u6709\\u4E2A\\u7591\\u95EE\\uFF0C\\u5F53\\u6211\\u6709\\u4E00\\u5806 promise \\u7684\\u65F6\\u5019\\uFF0C\\u600E\\u4E48\\u6309\\u987A\\u5E8F\\u6267\\u884C\\u5B83\\u4EEC\\u5462\\uFF1F\"), mdx(\"p\", null, \"\\u7F51\\u4E0A\\u641C\\u5230\\u7684\\u5927\\u591A\\u6570\\u6559\\u7A0B\\u90FD\\u662F\\u5EFA\\u4E00\\u4E2A\\u6570\\u7EC4\", mdx(\"inlineCode\", {\n    \"parentName\": \"p\"\n  }, \"array\"), \"\\uFF0C\\u628A promise \\u5BF9\\u8C61\\u653E\\u5230\\u6570\\u7EC4\\u91CC\\uFF0C\\u7136\\u540E\\u6570\\u7EC4\\u4E2D\\u7684 promise \\u5168\\u90E8\\u6267\\u884C\\u5B8C\\u6BD5\\u65F6\\u8C03\\u7528\", mdx(\"inlineCode\", {\n    \"parentName\": \"p\"\n  }, \"Promise.all(array)\"), \"\\u3002\\u7136\\u800C\\u8FD9\\u53EA\\u9002\\u7528\\u4E8E\\u6570\\u7EC4\\u4E2D\\u7684\", mdx(\"strong\", {\n    \"parentName\": \"p\"\n  }, \"promise \\u5BF9\\u8C61\\u4E0D\\u4E92\\u76F8\\u4F9D\\u8D56\"), \"\\u7684\\u60C5\\u51B5\\u3002\"), mdx(\"h3\", null, \"\\u95EE\\u9898\"), mdx(\"p\", null, \"\\u6211\\u4E4B\\u524D\\u63D0\\u5230\\u8FC7\\u4E00\\u4E2A\\u5178\\u578B\\u7684\\u4F8B\\u5B50\\u662F Facebook \\u7684 Graph API \\u4E2D\\u7684\\u5206\\u9875\\u95EE\\u9898\\uFF08 \", mdx(\"a\", {\n    \"href\": \"https://developers.facebook.com/docs/graph-api/using-graph-api#paging\",\n    \"parentName\": \"p\"\n  }, \"Cursor-based Pagination\"), \"\\uFF09\\uFF0CAPI \\u7684 Response \\u5982\\u4E0B\\uFF1A\"), mdx(\"pre\", null, mdx(\"code\", {\n    \"className\": \"language-json\",\n    \"parentName\": \"pre\"\n  }, \"{\\n  \\\"data\\\": [\\n     ... Endpoint data is here\\n  ],\\n  \\\"paging\\\": {\\n    \\\"cursors\\\": {\\n      \\\"after\\\": \\\"MTAxNTExOTQ1MjAwNzI5NDE=\\\",\\n      \\\"before\\\": \\\"NDMyNzQyODI3OTQw\\\"\\n    },\\n    \\\"previous\\\": \\\"https://graph.facebook.com/me/albums?limit=25&amp;before=NDMyNzQyODI3OTQw\\\",\\n    \\\"next\\\": \\\"https://graph.facebook.com/me/albums?limit=25&amp;after=MTAxNTExOTQ1MjAwNzI5NDE=\\\"\\n  }\\n}\\n\")), mdx(\"p\", null, \"\\u7B80\\u5355\\u7684\\u4E00\\u4E2A\\u4F8B\\u5B50\\u662F\\uFF0C\\u5F53\\u6211\\u60F3\\u8981\\u83B7\\u53D6\\u4E00\\u4E2A\\u4EBA\\u7684\\u5B8C\\u6574\\u597D\\u53CB\\u5217\\u8868\\uFF08Friend List\\uFF09\\uFF0C\\u4F46\\u662F\\u8FD9\\u4E2A\\u4EBA\\u597D\\u53CB\\u592A\\u591A\\u4E86\\uFF0C\\u5206\\u6210\\u4E86\\u5F88\\u591A\\u9875\\u3002\\u663E\\u7136\\u8FD9\\u4E9B\\u7ED3\\u679C\\u662F\\u4E92\\u76F8\\u4F9D\\u8D56\\u7684\\u3002\\u6211\\u5FC5\\u987B\\u5148\\u62FF\\u5230\\u7B2C\\u4E00\\u9875\\u7684\", mdx(\"inlineCode\", {\n    \"parentName\": \"p\"\n  }, \"paging.next\"), \"\\uFF0C\\u624D\\u80FD\\u8FDB\\u884C\\u4E0B\\u4E00\\u6B21\\u8BF7\\u6C42\\u3002\\uFF08\\u522B\\u8DDF\\u6211\\u8BF4\\u6539 query string \", mdx(\"inlineCode\", {\n    \"parentName\": \"p\"\n  }, \"limit\"), \"\\u540E\\u9762\\u7684\\u503C\\uFF0Climit \\u662F\\u6709\\u6700\\u5927\\u9650\\u5236\\u7684=\\uFF0C=\\uFF09\"), mdx(\"h3\", null, \"\\u89E3\\u51B3\\u65B9\\u6848\"), mdx(\"h5\", null, \"\\u5F53\\u77E5\\u9053\\u603B\\u5171\\u6709\\u591A\\u5C11\\u9875\\u7684\\u65F6\\u5019\"), mdx(\"p\", null, \"(\\u5047\\u8BBE request \\u662F\\u4E00\\u4E2A\\u8FD4\\u56DE promise \\u5BF9\\u8C61\\u7684\\u51FD\\u6570,resolve \\u7684\\u662F\\u4E0A\\u9762\\u7684 json)\"), mdx(\"ul\", null, mdx(\"li\", {\n    \"parentName\": \"ul\"\n  }, \"\\u666E\\u901A\\u7A0B\\u5E8F\\u5458\\u8FD9\\u4E48\\u505A\")), mdx(\"pre\", null, mdx(\"code\", {\n    \"className\": \"language-js\",\n    \"parentName\": \"pre\"\n  }, \"var url = 'http://xxx'; //first page\\nrequest(url)\\n  .then(function (data) {\\n    return request(data.next);\\n  })\\n  .then(function (data) {\\n    return request(data.next);\\n  }); //....then then then...\\n\")), mdx(\"p\", null, \"\\u5176\\u5B9E\\u8FD9\\u4E48\\u4E00\\u76F4 then \\u4E0B\\u53BB\\u4E5F\\u662F\\u53EF\\u4EE5\\u7684\\u2026\"), mdx(\"ul\", null, mdx(\"li\", {\n    \"parentName\": \"ul\"\n  }, \"\\u4E8C\\u903C\\u7A0B\\u5E8F\\u5458\\u8FD9\\u4E48\\u505A\\n\\u56DE\\u8C03\\u51FD\\u6570\\u5C42\\u5C42\\u5D4C\\u5957\\u2026Callback Hell\\u3002\")), mdx(\"h5\", null, \"\\u5F53\\u4E0D\\u77E5\\u9053\\u603B\\u5171\\u591A\\u5C11\\u9875\\u7684\\u65F6\\u5019\"), mdx(\"p\", null, \"\\u4E0D\\u505C then \\u7684\\u65B9\\u6CD5\\u5C31\\u4E0D\\u884C\\u4E86\\uFF0C\\u4E8E\\u662F\\u6709\\u4E86\\u6587\\u827A\\u7684\\u7A0B\\u5E8F\\u5458\"), mdx(\"ul\", null, mdx(\"li\", {\n    \"parentName\": \"ul\"\n  }, \"\\u6587\\u827A\\u7A0B\\u5E8F\\u5458\\u8FD9\\u4E48\\u505A\\n\\u9996\\u5148\\u8981\\u77E5\\u9053\\u7684\\u4E00\\u70B9\\u662F\\uFF0C\\u5F53\\u6CA1\\u6709\\u4E0B\\u4E00\\u9875\\u7684\\u65F6\\u5019\\uFF0C\\u8FD4\\u56DE\\u7684\", mdx(\"inlineCode\", {\n    \"parentName\": \"li\"\n  }, \"next=null\"), \"\\uFF0C\\u4E8E\\u662F\\u6211\\u4EEC\\u5C31\\u6709\\u4E86\\u9012\\u5F52\\u7684\\u7EC8\\u6B62\\u6761\\u4EF6\\u3002\")), mdx(\"pre\", null, mdx(\"code\", {\n    \"className\": \"language-js\",\n    \"parentName\": \"pre\"\n  }, \"function run(url) {\\n  if (!url) return;\\n  while (url) {\\n    return request(url).then(function (data) {\\n      run(data.paging.next);\\n    });\\n  }\\n}\\nvar url = 'http://xxx'; // first page\\nrun(url);\\n\")), mdx(\"h3\", null, \"\\u778E\\u626F\"), mdx(\"p\", null, \"\\u5D4C\\u5957\\u7684 Promise \\u5176\\u5B9E\", mdx(\"strong\", {\n    \"parentName\": \"p\"\n  }, \"\\u53EF\\u80FD\"), \"\\u662F\\u53CD\\u6A21\\u5F0F\\uFF08anti-pattern\\uFF09\", mdx(\"sup\", {\n    \"id\": \"fnref-1\",\n    \"parentName\": \"p\"\n  }, mdx(\"a\", {\n    \"href\": \"#fn-1\",\n    \"className\": \"footnote-ref\",\n    \"parentName\": \"sup\"\n  }, \"1\")), \"\\uFF0C\\u4F46\\u662F\\u672C\\u6587\\u4E2D\\u7684\\u60C5\\u51B5\\uFF0C\\u5982\\u679C\\u4E0D\\u9012\\u5F52\\u7528\\u5D4C\\u5957\\u7684 promise\\uFF0C\\u6211\\u5B9E\\u5728\\u60F3\\u4E0D\\u51FA\\u522B\\u7684\\u529E\\u6CD5\\u6765\\u4E86\\uFF08\\xA0(\\u0E51\\u2022\\u0301 \\u2083 \\u2022\\u0300)\\u5B9D\\u5B9D\\u5FC3\\u91CC\\u82E6\\uFF0C\\u4F46\\u5B9D\\u5B9D\\u4E0D\\u8BF4\\uFF09\"), mdx(\"p\", null, \"\\u4E3A\\u4EC0\\u4E48\\u8BF4\\u53EF\\u80FD\\u662F\\u5462\\uFF0C\\u56E0\\u4E3A\\u8C37\\u6B4C\\u4E00\\u641C\\u201Cpromise anti pattern nesting\\u201D\\uFF0C\\u603B\\u80FD\\u641C\\u51FA\\u4E00\\u5927\\u5806\\u5173\\u4E8E\\u5D4C\\u5957 promise \\u662F\\u53CD\\u6A21\\u5F0F\\u7684\\u6587\\u7AE0\\u3002\\u7136\\u800C bluebird \\u7684 wiki\", mdx(\"sup\", {\n    \"id\": \"fnref-2\",\n    \"parentName\": \"p\"\n  }, mdx(\"a\", {\n    \"href\": \"#fn-2\",\n    \"className\": \"footnote-ref\",\n    \"parentName\": \"sup\"\n  }, \"2\")), \"\\u4E2D\\uFF0C\\u5E76\\u6CA1\\u6709\\u63D0\\u5230\\u5D4C\\u5957\\u7684 promise \\u662F\\u53CD\\u6A21\\u5F0F\\u3002\"), mdx(\"p\", null, \"\\u6240\\u4EE5\\u5230\\u5E95\\u662F\\u4E0D\\u662F\\u53CD\\u6A21\\u5F0F\\uFF0C\\u6211\\u4E5F\\u4E0D\\u77E5\\u9053=\\uFF0C=\\u5927\\u6982\\u7684\\u60F3\\u6CD5\\u662F\\uFF0C\\u5728\\u80FD\\u4E0D\\u5D4C\\u5957\\u7684\\u65F6\\u5019\\u5C31\\u4E0D\\u8981\\u5D4C\\u5957\\uFF0C\\u5426\\u5219\\u8FD8\\u4E0D\\u5982\\u7528 callback\\u3002\"), mdx(\"p\", null, \"\\u80FD\\u4E0D\\u5D4C\\u5957\\u7684\\u60C5\\u51B5\\u662F\\u8BF4\\uFF0Cthen \\u7684\\u90FD\\u662F\\u5B8C\\u5168\\u4E0D\\u540C\\u7684 promise\\uFF0C\\u5982\\u679C\\u90FD\\u662F then \\u7C7B\\u4F3C\\u7684 promise\\uFF0C\\u90A3\\u4E48\\uFF0C\\u61D2\\u4EBA\\u8FD8\\u662F\\u9012\\u5F52\\u5427\\u2026\"), mdx(\"div\", {\n    \"className\": \"footnotes\"\n  }, mdx(\"hr\", {\n    \"parentName\": \"div\"\n  }), mdx(\"ol\", {\n    \"parentName\": \"div\"\n  }, mdx(\"li\", {\n    \"id\": \"fn-1\",\n    \"parentName\": \"ol\"\n  }, mdx(\"a\", {\n    \"href\": \"http://taoofcode.net/promise-anti-patterns/\",\n    \"parentName\": \"li\"\n  }, \"http://taoofcode.net/promise-anti-patterns/\"), mdx(\"a\", {\n    \"href\": \"#fnref-1\",\n    \"className\": \"footnote-backref\",\n    \"parentName\": \"li\"\n  }, \"\\u21A9\")), mdx(\"li\", {\n    \"id\": \"fn-2\",\n    \"parentName\": \"ol\"\n  }, mdx(\"a\", {\n    \"href\": \"https://github.com/petkaantonov/bluebird/wiki/Promise-anti-patterns\",\n    \"parentName\": \"li\"\n  }, \"https://github.com/petkaantonov/bluebird/wiki/Promise-anti-patterns\"), mdx(\"a\", {\n    \"href\": \"#fnref-2\",\n    \"className\": \"footnote-backref\",\n    \"parentName\": \"li\"\n  }, \"\\u21A9\")))));\n}\n;\nMDXContent.isMDXComponent = true;","excerpt":"2016-01-24 更新 \n我还是觉得嵌套多层的 promise 是反模式，不推荐使用，机智的我学会了另一种不嵌套不递归的方法，请看这里：\n Promise…","fields":{"slug":"/post/20160118-sequentialize-promise-by-recursion/"},"frontmatter":{"date":"2016-01-18T09:23:18.000Z","title":"递归实现按顺序执行Promise","tags":["promise","递归"],"category":"JS"},"tableOfContents":{"items":[{"url":"#问题","title":"问题"},{"url":"#解决方案","title":"解决方案"},{"url":"#瞎扯","title":"瞎扯"}]},"timeToRead":1}},"pageContext":{"postID":"abd80b36-49a3-58b7-b85b-3c1bd7f610ae","numericId":17,"prevPost":{"slug":"/post/20160112-ES6-generator-yield/","title":"对generator和yield的一些理解"},"nextPost":{"slug":"/post/20160122-understanding-of-CORS/","title":"对浏览器跨域问题的一些理解"}}},"staticQueryHashes":["2873555300"]}