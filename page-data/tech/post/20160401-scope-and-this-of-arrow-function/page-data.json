{"componentChunkName":"component---node-modules-gatsby-theme-replica-src-templates-post-tsx","path":"/tech/post/20160401-scope-and-this-of-arrow-function/","result":{"data":{"post":{"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"箭头函数的作用域和this\",\n  \"date\": \"2016-04-01T08:38:12.000Z\",\n  \"tags\": [\"es6\", \"箭头函数\", \"this\", \"作用域\", \"词法作用域\"],\n  \"category\": \"ES6\"\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"JS \\u91CC\\u7684\\u4F5C\\u7528\\u57DF\\u548C this \\u4E00\\u76F4\\u662F\\u4E00\\u4EF6\\u4EE4\\u4EBA\\u5934\\u75BC\\u7684\\u4E8B\\u60C5\\uFF0C\\u4EE5\\u524D\\u63A5\\u89E6\\u7684\\u4E0D\\u592A\\u591A\\uFF0C\\u6BD5\\u7ADF\\u9762\\u5411\\u8FC7\\u7A0B\\u7F16\\u7A0B\\u7684\\u6211\\u57FA\\u672C\\u4E0A\\u90FD\\u4E0D\\u4F1A\\u4F7F\\u7528\\u201C\\u7C7B\\u201D\\u8FD9\\u4E2A\\u6982\\u5FF5\\u3002\"), mdx(\"p\", null, \"\\u81EA\\u4ECE\\u5F00\\u59CB\\u5B66\\u4E60 ES6\\uFF0C\\u5F88\\u957F\\u4E00\\u6BB5\\u65F6\\u95F4\\u90FD\\u8BA4\\u4E3A\\u7BAD\\u5934\\u51FD\\u6570(Arrow Function)\", mdx(\"sup\", {\n    \"id\": \"fnref-1\",\n    \"parentName\": \"p\"\n  }, mdx(\"a\", {\n    \"href\": \"#fn-1\",\n    \"className\": \"footnote-ref\",\n    \"parentName\": \"sup\"\n  }, \"1\")), \"\\u5C31\\u662F\\u7ED9\\u61D2\\u4EBA\\u7528\\u7684\", mdx(\"strong\", {\n    \"parentName\": \"p\"\n  }, \"\\u7B80\\u5199\\u7684\\u533F\\u540D\\u51FD\\u6570\"), \"\\u800C\\u5DF2\\u3002\\u540E\\u6765\\u770B\\u5230\\u6709\\u4EBA\\u6311\\u6218\\u962E\\u4E00\\u5CF0\\u8001\\u5E08\", mdx(\"a\", {\n    \"href\": \"http://es6.ruanyifeng.com/\",\n    \"parentName\": \"p\"\n  }, \"\\u300AECMAScript 6 \\u5165\\u95E8\\u300B\"), \"\\u4E2D\\u5173\\u4E8E\\u7BAD\\u5934\\u51FD\\u6570 this \\u7684\\u4E00\\u4E9B\\u95EE\\u9898\", mdx(\"sup\", {\n    \"id\": \"fnref-2\",\n    \"parentName\": \"p\"\n  }, mdx(\"a\", {\n    \"href\": \"#fn-2\",\n    \"className\": \"footnote-ref\",\n    \"parentName\": \"sup\"\n  }, \"2\")), \"\\uFF0C\\u624D\\u5BF9\\u7BAD\\u5934\\u51FD\\u6570\\u6709\\u4E86\\u4E00\\u4E01\\u70B9\\u7684\\u7406\\u89E3\\u3002\"), mdx(\"p\", null, \"\\u6211\\u5E73\\u65F6\\u7684\\u5DE5\\u4F5C\\u57FA\\u672C\\u4E0A\\u90FD\\u662F\\u5404\\u79CD\\u7B2C\\u4E09\\u65B9\\u7684 API \\u6574\\u5408\\uFF0C\\u4E8E\\u662F\\u5404\\u79CD\\u5F02\\u6B65\\u8BF7\\u6C42\\uFF0Cpromise \\u90FD\\u662F\\u5BB6\\u5E38\\u4FBF\\u996D\\u3002\\u7531\\u4E8E SalesForce \\u6CA1\\u6709\\u76F4\\u63A5\\u7684 nodejs sdk\\uFF0C\\u6240\\u4EE5\\u81EA\\u5DF1\\u5199\\u4E00\\u4E2A\\u81EA\\u5B9A\\u4E49\\u7684\\u7C7B\\u5C31\\u4E0D\\u53EF\\u907F\\u514D\\u4E86\\u3002\\u5728\\u5199\\u7684\\u8FC7\\u7A0B\\u4E2D\\uFF0C\\u5173\\u4E8E this \\u8E29\\u5230\\u5751\\u91CC\\u4E86\\uFF0C\\u6240\\u4EE5\\u5C31\\u6709\\u4E86\\u8FD9\\u7BC7\\u6587\\u7AE0\\u3002\"), mdx(\"h3\", null, \"\\u573A\\u666F\"), mdx(\"p\", null, \"\\u5176\\u4E2D\\u4E00\\u4E2A\\u7B80\\u5355\\u7684\\u529F\\u80FD\\u662F\\uFF0C\\u67E5\\u627E\\u7528\\u6237\\u662F\\u5426\\u5B58\\u5728\\uFF0C\\u82E5\\u5B58\\u5728\\u5219\\u53D1\\u9001\\u6B22\\u8FCE\\u90AE\\u4EF6\\uFF08\\u6574\\u4E2A\\u6D41\\u7A0B\\u5BF9\\u5E94\", mdx(\"inlineCode\", {\n    \"parentName\": \"p\"\n  }, \"onBoardFlow\"), \"\\uFF09\\u3002\\u5B9E\\u9645\\u573A\\u666F\\u6BD4\\u8FD9\\u4E2A\\u8981\\u590D\\u6742\\uFF0C\\u53EF\\u80FD\\u9700\\u8981\\u8FDE\\u7EED\\u53D1\\u9001\\u597D\\u51E0\\u4E2A\\u8BF7\\u6C42\\uFF0C\\u4E3A\\u4E86\\u907F\\u514D\", mdx(\"em\", {\n    \"parentName\": \"p\"\n  }, \"\\u56DE\\u8C03\\u5730\\u72F1\"), \"\\uFF0C\\u6240\\u6709\\u7684\\u8BF7\\u6C42\\u6211\\u90FD\\u7528 promise \\u5305\\u4E86\\u8D77\\u6765\\u3002\"), mdx(\"pre\", null, mdx(\"code\", {\n    \"parentName\": \"pre\"\n  }, \"'use strict';\\nclass SalesForce {\\n  constructor(email, username) {\\n    this.email = email;\\n    this.username = username;\\n  }\\n  checkUser(){\\n    return getUserByName(this.username); //\\u53D1\\u9001\\u4E00\\u4E2A\\u8BF7\\u6C42\\u5230salesforce\\uFF0C\\u8FD4\\u56DE\\u4E00\\u4E2Apromise\\n  }\\n  sendEmail(){\\n    return send(this.email); //\\u53D1\\u9001\\u4E00\\u4E2A\\u8BF7\\u6C42\\u901A\\u77E5salesforce\\u53D1\\u9001\\u90AE\\u4EF6\\uFF0C\\u8FD4\\u56DE\\u4E00\\u4E2Apromise\\n  }\\n  onBoardFlow(){\\n    //....\\n  }\\n}\\n\")), mdx(\"h3\", null, \"\\u65B9\\u6848\"), mdx(\"p\", null, mdx(\"strong\", {\n    \"parentName\": \"p\"\n  }, \"\\u5728\", mdx(\"inlineCode\", {\n    \"parentName\": \"strong\"\n  }, \"onBoardFlow\"), \"\\u4E2D\\uFF0C\\u641E\\u4E0D\\u6E05 this \\u548C\\u4F5C\\u7528\\u57DF\\u7684\\u6211\\u9996\\u5148\\u8FD9\\u4E48\\u5199\\uFF1A\")), mdx(\"pre\", null, mdx(\"code\", {\n    \"parentName\": \"pre\"\n  }, \"//\\u4F8B1\\nthis.checkuser().then(this.sendEmail);  //Cannot read property 'email' of undefined\\n\")), mdx(\"p\", null, \"\\u7136\\u540E\\u60F3\\u5230\\u4E86\\u5728 promise \\u94FE\\u4E2D\\uFF0Cthis \\u6307\\u5411\\u7684\\u662F global\\uFF1B\"), mdx(\"blockquote\", null, mdx(\"p\", {\n    \"parentName\": \"blockquote\"\n  }, \"Q: \", mdx(\"strong\", {\n    \"parentName\": \"p\"\n  }, \"\\u4E3A\\u4EC0\\u4E48\\u80FD\\u627E\\u5230\", mdx(\"inlineCode\", {\n    \"parentName\": \"strong\"\n  }, \"this.sendEmail()\"), \"\\u65B9\\u6CD5\\uFF0C\\u5374\\u627E\\u4E0D\\u5230\", mdx(\"inlineCode\", {\n    \"parentName\": \"strong\"\n  }, \"this.email\"), \"\\u5C5E\\u6027\\u5462\\uFF1F\"), \"\\nA: \\u6211\\u7684\\u7406\\u89E3\\u662F\\uFF1A\\u56E0\\u4E3A\", mdx(\"inlineCode\", {\n    \"parentName\": \"p\"\n  }, \"this.sendEmail\"), \"\\u662F\\u4F5C\\u4E3A\\u53C2\\u6570\\u4F20\\u5165\\uFF0C\\u4F20\\u5165\\u7684 this \\u662F then \\u5916\\u90E8\\u7684 this\\uFF0C\\u4E5F\\u5C31\\u662F\", mdx(\"inlineCode\", {\n    \"parentName\": \"p\"\n  }, \"SalesForce\"), \"\\u5BF9\\u8C61\\uFF1B\\n\\u800C this.sendEmail \\u51FD\\u6570\\u7684\\u4F5C\\u7528\\u57DF\\u4E2D\\u4EA7\\u751F\\u4E86\", mdx(\"strong\", {\n    \"parentName\": \"p\"\n  }, \"\\u65B0\\u7684 this\"), \"\\uFF0C\\u800C\\u8FD9\\u4E2A this \\u6307\\u5411 global\\uFF08\\u6D4F\\u89C8\\u5668\\u4E2D\\u4E3A window \\u5BF9\\u8C61\\uFF09\\uFF1B\\u5728\\u4E25\\u683C\\u6A21\\u5F0F\\u4E0B this \\u4E3A undefined\\uFF1B\")), mdx(\"p\", null, mdx(\"strong\", {\n    \"parentName\": \"p\"\n  }, \"\\u7136\\u540E\\u5BB9\\u6613\\u60F3\\u5230\\u7684\\u5C31\\u662F\\u5404\\u79CD\", \"_\", \"this self\\uFF0C\\u7136\\u540E bind(this) call(\", \"_\", \"this)\\u4E4B\\u7C7B\\u7684\")), mdx(\"pre\", null, mdx(\"code\", {\n    \"parentName\": \"pre\"\n  }, \"//\\u4F8B2\\nthis.checkuser().then(this.sendEmail.bind(this));  //it works !\\n\")), mdx(\"p\", null, \"\\u8FD9\\u6837\\u662F\\u53EF\\u4EE5\\u6B63\\u5E38\\u5DE5\\u4F5C\\u7684\\uFF0C\\u4F46\\u611F\\u89C9\\u602A\\u602A\\u7684\\uFF0C\\u6BCF\\u4E2A then \\u90FD\\u8981\", mdx(\"inlineCode\", {\n    \"parentName\": \"p\"\n  }, \"bind(this)\"), \"\\u771F\\u662F\\u4E00\\u70B9\\u4E5F\\u4E0D\\u4F18\\u96C5\\u3002\"), mdx(\"p\", null, mdx(\"strong\", {\n    \"parentName\": \"p\"\n  }, \"\\u533F\\u540D\\u51FD\\u6570\\u548C\\u7BAD\\u5934\\u51FD\\u6570\\u539F\\u6765\\u4E0D\\u4E00\\u6837\\u554A\")), mdx(\"pre\", null, mdx(\"code\", {\n    \"parentName\": \"pre\"\n  }, \"//\\u4F8B3\\nthis.checkuser().then(function(){\\n  return this.sendEmail();\\n});  //Cannot read property 'updateFunnelData' of undefined\\n\")), mdx(\"p\", null, \"\\u6B64\\u65F6\", mdx(\"inlineCode\", {\n    \"parentName\": \"p\"\n  }, \"this.sendEmail\"), \"\\u7684 this \\u662F then \\u4E2D\\u7684\\u533F\\u540D\\u51FD\\u6570\\u65B0\\u4EA7\\u751F\\u7684 promise \\u4F5C\\u7528\\u57DF\\u4E0B\\u7684 this\\uFF0C\\u975E\\u4E25\\u683C\\u6A21\\u5F0F\\u4E0B\\u6307\\u5411 global\"), mdx(\"blockquote\", null, mdx(\"p\", {\n    \"parentName\": \"blockquote\"\n  }, \"\\u5728\\u7BAD\\u5934\\u51FD\\u6570\\u51FA\\u73B0\\u4E4B\\u524D\\uFF0C\\u6BCF\\u4E2A\\u65B0\\u5B9A\\u4E49\\u7684\\u51FD\\u6570\\u90FD\\u5C06\\u65B0\\u4EA7\\u751F\\u81EA\\u5DF1\\u4F5C\\u7528\\u57DF\\u4E0B\\u7684 this, arguments \\u7B49\\u5BF9\\u8C61\", mdx(\"sup\", {\n    \"id\": \"fnref-1\",\n    \"parentName\": \"p\"\n  }, mdx(\"a\", {\n    \"href\": \"#fn-1\",\n    \"className\": \"footnote-ref\",\n    \"parentName\": \"sup\"\n  }, \"1\")))), mdx(\"pre\", null, mdx(\"code\", {\n    \"parentName\": \"pre\"\n  }, \"\\u4F8B4\\nthis.checkuser().then(()=>this.sendEmail());  //it works!\\n\")), mdx(\"h3\", null, \"\\u8BCD\\u6CD5\\u4F5C\\u7528\\u57DF\"), mdx(\"p\", null, \"\\u4F5C\\u7528\\u57DF\\u5185\\u53EF\\u4EE5\\u5D4C\\u5957\\u4F5C\\u7528\\u57DF\\uFF0C\\u4ECE\\u800C\\u5F62\\u6210\\u4F5C\\u7528\\u57DF\\u94FE\\uFF0C\\u5728\\u6700\\u5916\\u5C42\\u7684\\u4E5F\\u5C31\\u662F\\u5168\\u5C40\\u4F5C\\u7528\\u57DF\\uFF0C\\u5F53\\u5728\\u5185\\u90E8\\u67E5\\u627E\\u4E00\\u4E2A\\u5BF9\\u8C61\\u65F6\\uFF0C\\u4F1A\\u987A\\u7740\\u4F5C\\u7528\\u57DF\\u94FE\\u6700\\u5185\\u5C42\\uFF0C\\u5C42\\u5C42\\u5411\\u5916\\u5BFB\\u627E\\uFF0C\\u76F4\\u5230\\u627E\\u5230\\u4E3A\\u6B62\\u3002\"), mdx(\"p\", null, \"\\u5728\\u4F8B 3 \\u4E2D\\uFF0C\\u533F\\u540D\\u51FD\\u6570\\u7684\\u4F5C\\u7528\\u57DF\\u4E2D\\u4EA7\\u751F\\u4E86\\u65B0\\u7684\", mdx(\"inlineCode\", {\n    \"parentName\": \"p\"\n  }, \"this\"), \"\\uFF0C\\u8BE5\", mdx(\"inlineCode\", {\n    \"parentName\": \"p\"\n  }, \"this\"), \"\\u6307\\u5411 global\\n\\u5728\\u4F8B 4 \\u4E2D\\uFF0C\\u7BAD\\u5934\\u51FD\\u6570\\u7684\\u4F5C\\u7528\\u57DF\\u4E2D\\u6CA1\\u6709\\u4EA7\\u751F\\u65B0\\u7684 this\\uFF0C\\u6240\\u4EE5\\u987A\\u7740\\u4F5C\\u7528\\u57DF\\u94FE\\u5C42\\u5C42\\u5F80\\u5916\\u5BFB\\u627E\", mdx(\"inlineCode\", {\n    \"parentName\": \"p\"\n  }, \"this\"), \"\\uFF0C\\u627E\\u5230\", mdx(\"inlineCode\", {\n    \"parentName\": \"p\"\n  }, \"onBoardFlow()\"), \"\\u7684\\u4F5C\\u7528\\u57DF\\u65F6\\uFF0C\\u627E\\u5230\\u4E86\", mdx(\"inlineCode\", {\n    \"parentName\": \"p\"\n  }, \"this\"), \"\\uFF0C\\u800C\\u6B64\\u65F6\", mdx(\"inlineCode\", {\n    \"parentName\": \"p\"\n  }, \"this\"), \"\\u5C31\\u662F\", mdx(\"inlineCode\", {\n    \"parentName\": \"p\"\n  }, \"SalesForce\"), \"\\u5BF9\\u8C61\"), mdx(\"h3\", null, \"\\u4E3A\\u4EC0\\u4E48 promise \\u4E2D\\u7684 this \\u6307\\u5411 global\"), mdx(\"p\", null, \"\\u8FD9\\u4E2A\\uFF0C\\u6211\\u8FD8\\u6CA1\\u5B66\\u4F1A\\u2026\"), mdx(\"div\", {\n    \"className\": \"footnotes\"\n  }, mdx(\"hr\", {\n    \"parentName\": \"div\"\n  }), mdx(\"ol\", {\n    \"parentName\": \"div\"\n  }, mdx(\"li\", {\n    \"id\": \"fn-1\",\n    \"parentName\": \"ol\"\n  }, mdx(\"a\", {\n    \"href\": \"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Functions/Arrow_functions\",\n    \"parentName\": \"li\"\n  }, \"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Functions/Arrow_functions\"), mdx(\"a\", {\n    \"href\": \"#fnref-1\",\n    \"className\": \"footnote-backref\",\n    \"parentName\": \"li\"\n  }, \"\\u21A9\")), mdx(\"li\", {\n    \"id\": \"fn-2\",\n    \"parentName\": \"ol\"\n  }, mdx(\"a\", {\n    \"href\": \"https://github.com/ruanyf/es6tutorial/issues/150\",\n    \"parentName\": \"li\"\n  }, \"https://github.com/ruanyf/es6tutorial/issues/150\"), mdx(\"a\", {\n    \"href\": \"#fnref-2\",\n    \"className\": \"footnote-backref\",\n    \"parentName\": \"li\"\n  }, \"\\u21A9\")))));\n}\n;\nMDXContent.isMDXComponent = true;","excerpt":"JS 里的作用域和 this 一直是一件令人头疼的事情，以前接触的不太多，毕竟面向过程编程的我基本上都不会使用“类”这个概念。 自从开始学习 ES6，很长一段时间都认为箭头函数(Arrow…","fields":{"slug":"/post/20160401-scope-and-this-of-arrow-function/"},"frontmatter":{"date":"2016-04-01T08:38:12.000Z","title":"箭头函数的作用域和this","tags":["es6","箭头函数","this","作用域","词法作用域"],"category":"ES6"},"tableOfContents":{"items":[{"url":"#场景","title":"场景"},{"url":"#方案","title":"方案"},{"url":"#词法作用域","title":"词法作用域"},{"url":"#为什么-promise-中的-this-指向-global","title":"为什么 promise 中的 this 指向 global"}]},"timeToRead":1}},"pageContext":{"postID":"6ccb419a-db7e-56ad-8bae-46a4e35240e9","numericId":26,"prevPost":{"slug":"/post/20160314-aws-ec2-ssh-access-mongodb-installation/","title":"AWS EC2 SSH访问 & mongodb 安装"},"nextPost":{"slug":"/post/20160412-babel-mocha-istanbul-es6-testing-and-coverage/","title":"结合使用Babel Mocha Istanbul进行ES6代码测试和覆盖率测试"}}},"staticQueryHashes":["2873555300"]}